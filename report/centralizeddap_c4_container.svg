<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="435px" preserveAspectRatio="none" style="width:1952px;height:435px;" version="1.1" viewBox="0 0 1952 435" width="1952px" zoomAndPan="magnify"><defs/><g><!--MD5=[cbe9dd51b20122de1aac021e30b09a22]
cluster MET--><rect fill="#FFFFFF" height="367" style="stroke: #444444; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;" width="1270" x="676" y="34.5659"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="84" x="1269" y="49.561">«boundary»</text><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="1257" y="67.7144">Met Norway</text><text fill="#444444" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1280" y="82.6265">[System]</text><!--MD5=[7e02d30a59f5a5ba5200e5b7709d2bfb]
entity dap--><rect fill="#438DD5" height="117.7813" style="stroke: #3C7FC0; stroke-width: 1.5;" width="186" x="1291" y="275.5659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="74" x="1347" y="296.7046">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="1306" y="314.3862">MET Norway Dap</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58" x="1355" y="333.0112">server</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="120" x="1324" y="347.9233">[Thredds OPeNDAP]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1386" y="363.7485"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="162" x="1305" y="380.0454">Centralized DAP server.</text><!--MD5=[e20c7447109d39a1ad45a88ec5f3ee86]
entity ecflow_job--><rect fill="#438DD5" height="115.4531" style="stroke: #3C7FC0; stroke-width: 1.5;" width="212" x="684" y="94.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="74" x="753" y="115.2046">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="748.5" y="132.8862">Batch job</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="121" x="729.5" y="147.7983">[Ecflow python job]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="792" y="163.6235"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="184" x="698" y="179.9204">Triggered on time or event</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="710" y="196.2173">and produce a dataset.</text><!--MD5=[bfc63d1b973df3b54defd7483ea381ac]
entity MMS--><rect fill="#438DD5" height="150.375" style="stroke: #3C7FC0; stroke-width: 1.5;" width="212" x="684" y="243.5659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="74" x="753" y="264.7046">«container»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="729.5" y="282.3862">External MET</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="707.5" y="301.0112">messaging system</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="751.5" y="315.9233">[REST/NATS]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="792" y="331.7485"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="150" x="715" y="348.0454">External events about</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="694" y="364.3423">dataset production, from all</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="770.5" y="380.6392">hubs.</text><!--MD5=[5cc83da0d7b22721bace1da08cb1645b]
entity prodhub--><rect fill="#999999" height="52.5938" style="stroke: #8A8A8A; stroke-width: 1.5;" width="157" x="1305.5" y="150.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="115" x="1326.5" y="171.2046">«external_system»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="1315.5" y="188.8862">Production Hub</text><!--MD5=[a3e3680f1d66b8c96b82f87c8184c790]
entity lustre_gateway--><rect fill="#999999" height="52.5938" style="stroke: #8A8A8A; stroke-width: 1.5;" width="216" x="1722" y="308.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="115" x="1772.5" y="329.2046">«external_system»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="1732" y="346.8862">Gateway to PPI lustre</text><!--MD5=[13667c3cc77eef8b4369a09bdfceffb1]
entity researcher--><rect fill="#08427B" height="52.5938" style="stroke: #073B6F; stroke-width: 1.5;" width="122" x="7" y="225.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="57" x="39.5" y="246.2046">«person»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="17" y="263.8862">Researcher</text><!--MD5=[d10672bb5e2bb769bc817e7102cbcce2]
entity jupyter--><rect fill="#999999" height="52.5938" style="stroke: #8A8A8A; stroke-width: 1.5;" width="135" x="325" y="225.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="115" x="335" y="246.2046">«external_system»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="344.5" y="263.8862">Jupyter lab</text><!--MD5=[11cb87260b5caddc0d8e4262c00388f3]
entity web_maps--><rect fill="#999999" height="71.2188" style="stroke: #8A8A8A; stroke-width: 1.5;" width="159" x="313" y="329.0659"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="115" x="335" y="350.2046">«external_system»</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="323" y="367.8862">Web page with</text><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="334.5" y="386.5112">climate maps</text><!--MD5=[3858197a5f8b168861edf814d4700bc3]
link dap to lustre_gateway--><path d="M1477.2246,334.5659 C1546.9258,334.5659 1642.5697,334.5659 1716.687,334.5659 " fill="none" id="dap-to-lustre_gateway" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1721.9856,334.5659,1712.9856,330.5659,1716.9856,334.5659,1712.9856,338.5659,1721.9856,334.5659" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="1539" y="316.6328">Access datasets</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="37" x="1581" y="330.8374">[CIFS]</text><!--MD5=[f118da7c52b4e135b090e4f24289c936]
link ecflow_job to prodhub--><path d="M896.1452,190.9076 C985.2026,218.9844 1115.7985,248.6677 1230,229.5659 C1259.2729,224.6696 1290.4312,214.8781 1317.0074,205.0289 " fill="none" id="ecflow_job-to-prodhub" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1321.9149,203.1903,1312.0836,202.602,1317.2327,204.9444,1314.8902,210.0935,1321.9149,203.1903" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="1082" y="195.6328">Access to schedule,</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="1104" y="210.7656">compute and</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1124.5" y="225.8984">storage.</text><!--MD5=[f118da7c52b4e135b090e4f24289c936]
link ecflow_job to prodhub--><path d="M896.1953,156.0354 C1011.7083,160.8971 1193.9998,168.5693 1299.9736,173.0295 " fill="none" id="ecflow_job-to-prodhub-1" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1305.2747,173.2526,1296.451,168.8774,1300.2791,173.0422,1296.1143,176.8703,1305.2747,173.2526" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="1091" y="131.6328">Register dataset</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1132.5" y="146.7656">event.</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="116" x="1097.5" y="160.9702">[CloudEvent/NATS]</text><!--MD5=[8a856b8ea1685740aac88fd51cf26b63]
link ecflow_job to dap--><path d="M874.628,209.094 C891.2004,218.8325 908.79,228.1688 926,235.5659 C1044.031,286.2977 1190.7317,312.1124 1285.8126,324.4461 " fill="none" id="ecflow_job-to-dap" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1290.8663,325.0953,1282.4494,319.9811,1285.9071,324.4582,1281.43,327.9159,1290.8663,325.0953" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="1105.5" y="268.6328">Poll to check</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="1085" y="283.7656">dataset availability</text><!--MD5=[b6775ef5f70e1fc86c6d47639dde0543]
link web_maps to MMS--><path d="M472.0939,356.5635 C523.9373,351.2228 593.0241,343.8644 654,336.5659 C662.0293,335.6049 670.3211,334.5821 678.6645,333.5309 " fill="none" id="web_maps-to-MMS" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="683.8642,332.873,674.4332,330.0346,678.9038,333.5007,675.4376,337.9713,683.8642,332.873" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="509.5" y="317.6328">Listen for dataset</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="553.5" y="332.7656">events</text><!--MD5=[a07fc8515d7571078c3c18bc25ad48c6]
link web_maps to dap--><path d="M472.1224,381.0027 C528.7135,391.8204 606.6667,404.9775 676,410.5659 C894.0735,428.143 1148.992,385.0971 1285.595,356.8461 " fill="none" id="web_maps-to-dap" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1290.8055,355.7638,1281.1801,353.6777,1285.91,356.7807,1282.8071,361.5105,1290.8055,355.7638" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="927" y="363.6328">Stream relevant</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="950" y="378.7656">fresh data</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="34" x="971.5" y="392.9702">[DAP]</text><!--MD5=[69acd9a52e3f9151abf8003619d4d6fb]
link researcher to jupyter--><path d="M129.036,251.5659 C183.1241,251.5659 262.198,251.5659 319.5955,251.5659 " fill="none" id="researcher-to-jupyter" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="324.7319,251.5659,315.7319,247.5659,319.7319,251.5659,315.7319,255.5659,324.7319,251.5659" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="160" y="218.6328">Interactive data</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="196" y="233.7656">mining</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="64" x="189" y="247.9702">[Web GUI]</text><!--MD5=[11950482ad3327c417a7691b4753ea99]
link jupyter to MMS--><path d="M460.381,263.0075 C520.2551,273.0995 608.6536,287.9994 678.8372,299.8291 " fill="none" id="jupyter-to-MMS" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="683.8583,300.6754,675.6484,295.235,678.9279,299.8443,674.3186,303.1237,683.8583,300.6754" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="503" y="252.6328">Get latest event for</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="76" x="540" y="267.7656">a dataset.</text><!--MD5=[5e645c70572361247cd61d876dca56d9]
link jupyter to dap--><path d="M422.4664,225.0558 C471.3999,183.7373 573.3378,105.7 676,76.5659 C770.0634,49.8721 798.348,71.6084 896,76.5659 C1045.0197,84.1312 1105.4325,28.4255 1230,110.5659 C1276.6699,141.3403 1259.6516,174.2797 1291,220.5659 C1302.5536,237.6249 1316.0597,255.2519 1329.1408,271.3953 " fill="none" id="jupyter-to-dap" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="1332.4559,275.4664,1329.8747,265.9618,1329.2987,271.5893,1323.6713,271.0133,1332.4559,275.4664" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="927.5" y="19.6328">Stream variable</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="937.5" y="34.7656">from specific</text><text fill="#666666" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="960" y="49.8984">dataset</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="34" x="971.5" y="64.103">[DAP]</text><!--MD5=[dc9aed82e323a0301f1f5de959aa1f68]
@startuml Data access context diagram
!includeurl https://raw.githubusercontent.com/RicardoNiepel/C4-PlantUML/master/C4_Container.puml

LAYOUT_LEFT_RIGHT

System_Boundary(MET, "Met Norway"){
    Container(dap, "MET Norway Dap server", "Thredds OPeNDAP", "Centralized DAP server.")
    Container(ecflow_job, "Batch job", "Ecflow python job", "Triggered on time or event and produce a dataset.")
    Container(MMS, "External MET messaging system", "REST/NATS", "External events about dataset production, from all hubs.")

    System_Ext(prodhub, "Production Hub")
    System_Ext(lustre_gateway, "Gateway to PPI lustre")

    Rel(dap, lustre_gateway, "Access datasets", "CIFS")
    Rel(ecflow_job, prodhub, "Access to schedule, compute and storage.")
    Rel(ecflow_job, dap, "Poll to check dataset availability")
    Rel(ecflow_job, prodhub, "Register dataset event.", "CloudEvent/NATS")
}

Person(researcher, "Researcher")
System_Ext(jupyter, "Jupyter lab")
System_Ext(web_maps, "Web page with climate maps")

Rel(web_maps, MMS, "Listen for dataset events")
Rel(web_maps, dap, "Stream relevant fresh data", "DAP")

Rel(researcher, jupyter, "Interactive data mining", "Web GUI")
Rel(jupyter, MMS, "Get latest event for a dataset.")
Rel(jupyter, dap, "Stream variable from specific dataset", "DAP")
@enduml

@startuml Data access context diagram





skinparam defaultTextAlignment center

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam rectangle {
    StereotypeFontSize 12
    shadowing false
}

skinparam database {
    StereotypeFontSize 12
    shadowing false
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

skinparam rectangle<<boundary>> {
    Shadowing false
    StereotypeFontSize 0
    FontColor #444444
    BorderColor #444444
    BorderStyle dashed
}






















skinparam rectangle<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}

skinparam rectangle<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}

skinparam rectangle<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam rectangle<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}

skinparam database<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam database<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
















skinparam rectangle<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}

skinparam database<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}








left to right direction

rectangle "==Met Norway\n<size:12>[System]</size>" <<boundary>> as MET{
    rectangle "==MET Norway Dap server\n//<size:12>[Thredds OPeNDAP]</size>//\n\n Centralized DAP server." <<container>> as dap
    rectangle "==Batch job\n//<size:12>[Ecflow python job]</size>//\n\n Triggered on time or event and produce a dataset." <<container>> as ecflow_job
    rectangle "==External MET messaging system\n//<size:12>[REST/NATS]</size>//\n\n External events about dataset production, from all hubs." <<container>> as MMS

    rectangle "==Production Hub" <<external_system>> as prodhub
    rectangle "==Gateway to PPI lustre" <<external_system>> as lustre_gateway

    dap - -> lustre_gateway : "===Access datasets\n//<size:12>[CIFS]</size>//"
    ecflow_job - -> prodhub : "===Access to schedule, compute and storage."
    ecflow_job - -> dap : "===Poll to check dataset availability"
    ecflow_job - -> prodhub : "===Register dataset event.\n//<size:12>[CloudEvent/NATS]</size>//"
}

rectangle "==Researcher" <<person>> as researcher
rectangle "==Jupyter lab" <<external_system>> as jupyter
rectangle "==Web page with climate maps" <<external_system>> as web_maps

web_maps - -> MMS : "===Listen for dataset events"
web_maps - -> dap : "===Stream relevant fresh data\n//<size:12>[DAP]</size>//"

researcher - -> jupyter : "===Interactive data mining\n//<size:12>[Web GUI]</size>//"
jupyter - -> MMS : "===Get latest event for a dataset."
jupyter - -> dap : "===Stream variable from specific dataset\n//<size:12>[DAP]</size>//"
@enduml

PlantUML version 1.2020.18(Wed Sep 30 21:40:44 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>